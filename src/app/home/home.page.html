<ion-header class="home-header ion-no-border">
  <ion-toolbar class="header-toolbar">
    <ion-title class="brand-title">
      <div class="brand-wrapper">
        <span class="brand-text">Chronos</span>
        <img src="assets/icon/icon-Chronos.png" alt="Chronos" class="brand-logo">
      </div>
    </ion-title>
    <ion-buttons slot="end">


    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="home-content">
  <!-- Hero Section (scrollable) -->
  <div class="header-hero-section">
    <div class="header-hero">
      <div class="hero-left">
        <div class="hello">Hola,</div>
        <h1 class="student-name">{{ alumno?.nombreCompleto || 'Estudiante' }}</h1>
        <p class="sub">Aprender es tu superpoder. ¡Vamos por más!</p>
      </div>
      <ion-avatar class="hero-avatar" [routerLink]="['/profile']" style="cursor: pointer;">
        <img src="assets/images/avatar-default.png" alt="Avatar" />
      </ion-avatar>
    </div>
    <ion-grid class="quick-stats">
      <ion-row>
        <ion-col size="4">
          <div class="stat">
            <ion-icon name="ribbon-outline"></ion-icon>
            <div class="kpi">{{ promedioGeneral }}</div>
            <div class="lbl">Promedio General</div>
          </div>
        </ion-col>
        <ion-col size="4">
          <div class="stat">
            <ion-icon name="calendar-outline"></ion-icon>
            <div class="kpi">90%</div>
            <div class="lbl">Asistencia Total</div>
          </div>
        </ion-col>
        <ion-col size="4">
          <div class="stat">
            <ion-icon name="book-outline"></ion-icon>
            <div class="kpi">{{ cantidadRamos }}</div>
            <div class="lbl">Ramos</div>
          </div>
        </ion-col>
      </ion-row>
    </ion-grid>
  </div>

  <!-- Asistencia -->
  <ion-card class="card attendance">
    <ion-card-header>
      <ion-card-title>Asistencia mensual</ion-card-title>
      <ion-card-subtitle>Objetivo: 85% o más</ion-card-subtitle>
    </ion-card-header>
    <ion-card-content>
      <div class="row">
        <h2>18 / 20 días</h2>
        <ion-button fill="clear" size="small" color="primary">
          Ver detalles
          <ion-icon name="chevron-forward-outline"></ion-icon>
        </ion-button>
      </div>
      <ion-progress-bar value="0.9" class="progress-lg"></ion-progress-bar>
      <div class="muted">90% de asistencia</div>
    </ion-card-content>
  </ion-card>

  <!-- Últimas notas -->
  <ion-card class="card last-grades">
    <ion-card-header>
      <ion-card-title>Últimas notas</ion-card-title>
      <ion-card-subtitle>Seguimiento académico</ion-card-subtitle>
    </ion-card-header>
    <ion-list lines="none" class="grade-list">
      <ion-item *ngFor="let nota of ultimasNotas">
        <ion-icon name="document-text-outline" slot="start" class="subj"></ion-icon>
        <ion-label>
          <h3>{{ nota.asignatura }}</h3>
          <p>{{ nota.fecha | date:'dd MMM' }}</p>
        </ion-label>
        <!-- Chip con color dinámico de fondo (transparente) -->
        <ion-chip [style.--background]="nota.color">
          <ion-label><strong>{{ nota.valor }}</strong></ion-label>
        </ion-chip>
        <ion-badge [color]="nota.estado.color">{{ nota.estado.texto }}</ion-badge>
      </ion-item>

      <ion-item *ngIf="ultimasNotas.length === 0">
        <ion-label class="ion-text-center">
          <p>No hay notas registradas aún.</p>
        </ion-label>
      </ion-item>
    </ion-list>
  </ion-card>

  <!-- Próximas actividades -->
  <ion-card class="card upcoming">
    <ion-card-header>
      <ion-card-title>Próximas actividades</ion-card-title>
      <ion-card-subtitle>Organiza tu semana</ion-card-subtitle>
    </ion-card-header>
    <ion-list lines="none">
      <ion-item>
        <ion-icon name="calendar-number-outline" slot="start" color="primary"></ion-icon>
        <ion-label>
          <h3>Control de Matemáticas</h3>
          <p>Jueves, 10:00 - Sala B12</p>
        </ion-label>
        <ion-badge color="tertiary">Prioridad alta</ion-badge>
      </ion-item>
      <ion-item>
        <ion-icon name="document-text-outline" slot="start" color="success"></ion-icon>
        <ion-label>
          <h3>Ensayo de Lenguaje</h3>
          <p>Viernes, 11:30 - Biblioteca</p>
        </ion-label>
      </ion-item>
    </ion-list>
  </ion-card>

  <!-- Consejo del día -->
  <ion-card class="card tip">
    <ion-card-content>
      <ion-icon name="bulb-outline"></ion-icon>
      <div>
        <h3>Consejo del día</h3>
        <p>Estudiar 25 minutos y descansar 5 te ayuda a concentrarte mejor. Técnica Pomodoro.</p>
      </div>
    </ion-card-content>
  </ion-card>

  <ion-fab vertical="bottom" horizontal="end" slot="fixed">
    <ion-fab-button routerLink="/chat" color="primary">
      <ion-icon name="chatbubble"></ion-icon>
    </ion-fab-button>
  </ion-fab>

</ion-content>

<ion-footer class="tabs">
  <ion-toolbar>
    <ion-tabs>
      <ion-tab-bar slot="bottom">
        <ion-tab-button routerLink="/home" selected="true">
          <ion-icon ios="home-outline" md="home-sharp"></ion-icon>
          <ion-label>Inicio</ion-label>
        </ion-tab-button>
        <ion-tab-button routerLink="/notas">
          <ion-icon ios="book-outline" md="book-sharp"></ion-icon>
          <ion-label>Notas</ion-label>
        </ion-tab-button>
        <ion-tab-button routerLink="/asistencia">
          <ion-icon ios="calendar-outline" md="calendar-sharp"></ion-icon>
          <ion-label>Asistencia</ion-label>
        </ion-tab-button>
        <ion-tab-button routerLink="/chat">
          <ion-icon ios="chatbubbles-outline" md="chatbubbles-sharp"></ion-icon>
          <ion-label>Chat</ion-label>
        </ion-tab-button>
      </ion-tab-bar>
    </ion-tabs>
  </ion-toolbar>
</ion-footer>