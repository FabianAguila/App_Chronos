{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/braya/Downloads/ChronosActualizado_modificado/ProyectoAppRegis/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { FormBuilder, Validators } from '@angular/forms';\nimport { ApiService } from '../servicios/api.service';\nimport { NavController, ToastController } from '@ionic/angular';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"../servicios/api.service\";\nimport * as i3 from \"@ionic/angular\";\nimport * as i4 from \"@angular/common\";\nfunction SignupPage_ng_container_53_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.…µ…µelementContainerStart(0);\n    i0.…µ…µelementStart(1, \"div\", 26);\n    i0.…µ…µtext(2, \"Datos del veh\\u00EDculo\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(3, \"ion-item\", 15)(4, \"ion-label\", 16);\n    i0.…µ…µtext(5, \"Matr\\u00EDcula\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µelement(6, \"ion-input\", 27);\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(7, \"ion-item\", 15)(8, \"ion-label\", 16);\n    i0.…µ…µtext(9, \"Descripci\\u00F3n del Veh\\u00EDculo\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µelement(10, \"ion-input\", 28);\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementContainerEnd();\n  }\n}\nexport let SignupPage = /*#__PURE__*/(() => {\n  class SignupPage {\n    constructor(fb, api, navCtrl, toastCtrl) {\n      this.fb = fb;\n      this.api = api;\n      this.navCtrl = navCtrl;\n      this.toastCtrl = toastCtrl;\n      this.formRegis = this.fb.group({\n        nombreCompleto: ['', Validators.required],\n        fechaNacimiento: ['', Validators.required],\n        rut: ['', Validators.required],\n        correoElectronico: ['', [Validators.required, Validators.email]],\n        contrasena: ['', Validators.required],\n        usaVehiculo: [false],\n        matricula: [''],\n        descripcionVehiculo: ['']\n      });\n    }\n    toggleVehiculo() {\n      if (!this.formRegis.get('usaVehiculo')?.value) {\n        this.formRegis.patchValue({\n          matricula: '',\n          descripcionVehiculo: ''\n        });\n      }\n    }\n    registrarAlumno() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        if (_this.formRegis.invalid) {\n          const toast = yield _this.toastCtrl.create({\n            message: 'Por favor completa todos los campos obligatorios',\n            duration: 2000,\n            color: 'warning'\n          });\n          yield toast.present();\n          return;\n        }\n        // Transformar a PascalCase para el backend .NET\n        const formValue = _this.formRegis.value;\n        // Asegurar formato de fecha correcto\n        let fechaNacimiento = formValue.fechaNacimiento;\n        if (fechaNacimiento && typeof fechaNacimiento === 'string') {\n          // ion-datetime devuelve ISO string, asegurar que est√© bien formateado\n          fechaNacimiento = new Date(fechaNacimiento).toISOString();\n        }\n        const alumno = {\n          NombreCompleto: formValue.nombreCompleto,\n          FechaNacimiento: fechaNacimiento,\n          Rut: formValue.rut,\n          CorreoElectronico: formValue.correoElectronico?.trim(),\n          Contrasena: formValue.contrasena?.trim(),\n          Matricula: formValue.matricula || '',\n          DescripcionVehiculo: formValue.descripcionVehiculo || ''\n        };\n        console.log('üìù Registrando alumno:', {\n          ...alumno,\n          Contrasena: '***'\n        });\n        try {\n          yield _this.api.registrarAlumno(alumno).toPromise();\n          console.log('‚úÖ Registro exitoso');\n          const toast = yield _this.toastCtrl.create({\n            message: 'Registro exitoso',\n            duration: 2000,\n            color: 'success'\n          });\n          yield toast.present();\n          _this.navCtrl.navigateRoot('/login');\n        } catch (error) {\n          console.error('‚ùå Error al registrar:', error);\n          let mensaje = 'Error al registrar';\n          if (error && typeof error === 'object' && 'error' in error) {\n            const err = error;\n            if (typeof err.error === 'string') {\n              mensaje = err.error;\n            } else if (err.status === 409) {\n              mensaje = 'El correo ya est√° registrado';\n            }\n          }\n          const toast = yield _this.toastCtrl.create({\n            message: mensaje,\n            duration: 2000,\n            color: 'danger'\n          });\n          yield toast.present();\n        }\n      })();\n    }\n  }\n  SignupPage.…µfac = function SignupPage_Factory(t) {\n    return new (t || SignupPage)(i0.…µ…µdirectiveInject(i1.FormBuilder), i0.…µ…µdirectiveInject(i2.ApiService), i0.…µ…µdirectiveInject(i3.NavController), i0.…µ…µdirectiveInject(i3.ToastController));\n  };\n  SignupPage.…µcmp = /*@__PURE__*/i0.…µ…µdefineComponent({\n    type: SignupPage,\n    selectors: [[\"app-signup\"]],\n    decls: 56,\n    vars: 3,\n    consts: [[1, \"register-header\"], [1, \"header-toolbar\"], [1, \"brand\"], [\"name\", \"school-outline\"], [1, \"brand-title\"], [1, \"brand-subtitle\"], [1, \"quick-stats\"], [\"size\", \"6\"], [1, \"stat\"], [1, \"kpi\"], [1, \"lbl\"], [1, \"register-content\", \"ion-padding\"], [1, \"form-wrapper\"], [1, \"card\", \"form-card\"], [3, \"formGroup\", \"ngSubmit\"], [\"lines\", \"full\"], [\"position\", \"floating\"], [\"formControlName\", \"nombreCompleto\"], [\"formControlName\", \"fechaNacimiento\", \"type\", \"text\", \"placeholder\", \"dd/mm/aaaa\", \"inputmode\", \"numeric\"], [\"formControlName\", \"rut\"], [\"formControlName\", \"correoElectronico\", \"type\", \"email\"], [\"formControlName\", \"contrasena\", \"type\", \"password\"], [\"lines\", \"none\", 1, \"vehicle-toggle\"], [\"formControlName\", \"usaVehiculo\", 3, \"ionChange\"], [4, \"ngIf\"], [\"expand\", \"block\", \"type\", \"submit\", 1, \"submit-btn\", 3, \"disabled\"], [1, \"section-title\"], [\"formControlName\", \"matricula\"], [\"formControlName\", \"descripcionVehiculo\"]],\n    template: function SignupPage_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.…µ…µelementStart(0, \"ion-header\", 0)(1, \"ion-toolbar\", 1)(2, \"ion-title\")(3, \"div\", 2);\n        i0.…µ…µelement(4, \"ion-icon\", 3);\n        i0.…µ…µelementStart(5, \"div\")(6, \"div\", 4);\n        i0.…µ…µtext(7, \"Registro de Alumno\");\n        i0.…µ…µelementEnd();\n        i0.…µ…µelementStart(8, \"div\", 5);\n        i0.…µ…µtext(9, \"Acceso a la comunidad educativa\");\n        i0.…µ…µelementEnd()()()()();\n        i0.…µ…µelementStart(10, \"div\", 6)(11, \"ion-grid\")(12, \"ion-row\")(13, \"ion-col\", 7)(14, \"div\", 8)(15, \"div\", 9);\n        i0.…µ…µtext(16, \"Seguro\");\n        i0.…µ…µelementEnd();\n        i0.…µ…µelementStart(17, \"div\", 10);\n        i0.…µ…µtext(18, \"Tus datos est\\u00E1n protegidos\");\n        i0.…µ…µelementEnd()()()()()()();\n        i0.…µ…µelementStart(19, \"ion-content\", 11)(20, \"div\", 12)(21, \"ion-card\", 13)(22, \"ion-card-header\")(23, \"ion-card-title\");\n        i0.…µ…µtext(24, \"Crear cuenta de alumno\");\n        i0.…µ…µelementEnd();\n        i0.…µ…µelementStart(25, \"ion-card-subtitle\");\n        i0.…µ…µtext(26, \" Completa los campos para registrarte en la plataforma. \");\n        i0.…µ…µelementEnd()();\n        i0.…µ…µelementStart(27, \"ion-card-content\")(28, \"form\", 14);\n        i0.…µ…µlistener(\"ngSubmit\", function SignupPage_Template_form_ngSubmit_28_listener() {\n          return ctx.registrarAlumno();\n        });\n        i0.…µ…µelementStart(29, \"ion-item\", 15)(30, \"ion-label\", 16);\n        i0.…µ…µtext(31, \"Nombre Completo\");\n        i0.…µ…µelementEnd();\n        i0.…µ…µelement(32, \"ion-input\", 17);\n        i0.…µ…µelementEnd();\n        i0.…µ…µelementStart(33, \"ion-item\", 15)(34, \"ion-label\", 16);\n        i0.…µ…µtext(35, \"Fecha de Nacimiento\");\n        i0.…µ…µelementEnd();\n        i0.…µ…µelement(36, \"ion-input\", 18);\n        i0.…µ…µelementEnd();\n        i0.…µ…µelementStart(37, \"ion-item\", 15)(38, \"ion-label\", 16);\n        i0.…µ…µtext(39, \"RUT\");\n        i0.…µ…µelementEnd();\n        i0.…µ…µelement(40, \"ion-input\", 19);\n        i0.…µ…µelementEnd();\n        i0.…µ…µelementStart(41, \"ion-item\", 15)(42, \"ion-label\", 16);\n        i0.…µ…µtext(43, \"Correo Electr\\u00F3nico\");\n        i0.…µ…µelementEnd();\n        i0.…µ…µelement(44, \"ion-input\", 20);\n        i0.…µ…µelementEnd();\n        i0.…µ…µelementStart(45, \"ion-item\", 15)(46, \"ion-label\", 16);\n        i0.…µ…µtext(47, \"Contrase\\u00F1a\");\n        i0.…µ…µelementEnd();\n        i0.…µ…µelement(48, \"ion-input\", 21);\n        i0.…µ…µelementEnd();\n        i0.…µ…µelementStart(49, \"ion-item\", 22)(50, \"ion-label\");\n        i0.…µ…µtext(51, \"\\u00BFUsa veh\\u00EDculo?\");\n        i0.…µ…µelementEnd();\n        i0.…µ…µelementStart(52, \"ion-toggle\", 23);\n        i0.…µ…µlistener(\"ionChange\", function SignupPage_Template_ion_toggle_ionChange_52_listener() {\n          return ctx.toggleVehiculo();\n        });\n        i0.…µ…µelementEnd()();\n        i0.…µ…µtemplate(53, SignupPage_ng_container_53_Template, 11, 0, \"ng-container\", 24);\n        i0.…µ…µelementStart(54, \"ion-button\", 25);\n        i0.…µ…µtext(55, \" Registrarse \");\n        i0.…µ…µelementEnd()()()()()();\n      }\n      if (rf & 2) {\n        let tmp_1_0;\n        i0.…µ…µadvance(28);\n        i0.…µ…µproperty(\"formGroup\", ctx.formRegis);\n        i0.…µ…µadvance(25);\n        i0.…µ…µproperty(\"ngIf\", (tmp_1_0 = ctx.formRegis.get(\"usaVehiculo\")) == null ? null : tmp_1_0.value);\n        i0.…µ…µadvance(1);\n        i0.…µ…µproperty(\"disabled\", ctx.formRegis.invalid);\n      }\n    },\n    dependencies: [i4.NgIf, i1.…µNgNoValidate, i1.NgControlStatus, i1.NgControlStatusGroup, i3.IonButton, i3.IonCard, i3.IonCardContent, i3.IonCardHeader, i3.IonCardSubtitle, i3.IonCardTitle, i3.IonCol, i3.IonContent, i3.IonGrid, i3.IonHeader, i3.IonIcon, i3.IonInput, i3.IonItem, i3.IonLabel, i3.IonRow, i3.IonTitle, i3.IonToggle, i3.IonToolbar, i3.BooleanValueAccessor, i3.TextValueAccessor, i1.FormGroupDirective, i1.FormControlName],\n    encapsulation: 2\n  });\n  return SignupPage;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}