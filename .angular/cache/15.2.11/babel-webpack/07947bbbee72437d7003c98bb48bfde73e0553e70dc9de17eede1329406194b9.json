{"ast":null,"code":"import _asyncToGenerator from \"E:/Git_Chronos/App_Chronos/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { ApiService } from '../servicios/api.service';\nimport { Preferences } from '@capacitor/preferences';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../servicios/api.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@ionic/angular\";\nimport * as i4 from \"@angular/router\";\nfunction NotasPage_div_32_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 27);\n    i0.ɵɵelement(1, \"ion-spinner\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction NotasPage_ion_list_33_div_1_div_18_ion_item_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\", 47)(1, \"ion-label\")(2, \"h3\", 48);\n    i0.ɵɵtext(3, \"Nota\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\", 49);\n    i0.ɵɵtext(5);\n    i0.ɵɵpipe(6, \"date\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(7, \"ion-badge\", 50);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const nota_r7 = ctx.$implicit;\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\"\", i0.ɵɵpipeBind2(6, 2, nota_r7.fecha || \"\", \"dd/MM/yyyy\"), \" \");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(nota_r7.valor || nota_r7.nota);\n  }\n}\nfunction NotasPage_ion_list_33_div_1_div_18_ion_item_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\", 51)(1, \"ion-label\", 52)(2, \"p\", 53);\n    i0.ɵɵtext(3, \"Sin notas registradas\");\n    i0.ɵɵelementEnd()()();\n  }\n}\nfunction NotasPage_ion_list_33_div_1_div_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 43)(1, \"ion-list\", 44);\n    i0.ɵɵtemplate(2, NotasPage_ion_list_33_div_1_div_18_ion_item_2_Template, 9, 5, \"ion-item\", 45);\n    i0.ɵɵtemplate(3, NotasPage_ion_list_33_div_1_div_18_ion_item_3_Template, 4, 0, \"ion-item\", 46);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const insc_r3 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", insc_r3.notas);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !insc_r3.notas || insc_r3.notas.length === 0);\n  }\n}\nfunction NotasPage_ion_list_33_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 30)(1, \"ion-item\", 31);\n    i0.ɵɵlistener(\"click\", function NotasPage_ion_list_33_div_1_Template_ion_item_click_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r10);\n      const insc_r3 = restoredCtx.$implicit;\n      const ctx_r9 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r9.toggleAsignatura(insc_r3.id));\n    });\n    i0.ɵɵelement(2, \"ion-icon\", 32);\n    i0.ɵɵelementStart(3, \"ion-label\")(4, \"div\", 33)(5, \"h3\", 34);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"ion-chip\", 35)(8, \"ion-label\", 36);\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(10, \"div\", 37);\n    i0.ɵɵelement(11, \"div\", 38);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"p\", 39);\n    i0.ɵɵtext(13, \"Promedio: \");\n    i0.ɵɵelementStart(14, \"b\", 40);\n    i0.ɵɵtext(15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(16, \" / 7.0\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(17, \"ion-icon\", 41);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(18, NotasPage_ion_list_33_div_1_div_18_Template, 4, 2, \"div\", 42);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const insc_r3 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵclassProp(\"expanded\", ctx_r2.isExpanded(insc_r3.id));\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate((insc_r3.asignatura == null ? null : insc_r3.asignatura.nombre) || \"Asignatura\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"color\", ctx_r2.getEstadoAsignatura(ctx_r2.getPromedioAsignatura(insc_r3)).color);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r2.getEstadoAsignatura(ctx_r2.getPromedioAsignatura(insc_r3)).texto);\n    i0.ɵɵadvance(2);\n    i0.ɵɵstyleProp(\"width\", ctx_r2.getProgreso(ctx_r2.getPromedioAsignatura(insc_r3)), \"%\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(ctx_r2.fmt(ctx_r2.getPromedioAsignatura(insc_r3)));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"name\", ctx_r2.isExpanded(insc_r3.id) ? \"chevron-down-outline\" : \"chevron-forward-outline\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.isExpanded(insc_r3.id));\n  }\n}\nfunction NotasPage_ion_list_33_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-list\", 28);\n    i0.ɵɵtemplate(1, NotasPage_ion_list_33_div_1_Template, 19, 10, \"div\", 29);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.inscripciones);\n  }\n}\nexport let NotasPage = /*#__PURE__*/(() => {\n  class NotasPage {\n    constructor(apiService) {\n      this.apiService = apiService;\n      this.inscripciones = [];\n      this.expandedAsignaturas = new Set();\n      this.loading = true;\n    }\n    ngOnInit() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        const res = yield Preferences.get({\n          key: 'alumnoId'\n        });\n        const id = res.value;\n        if (id && !isNaN(+id)) {\n          _this.cargarInscripciones(+id);\n        } else {\n          _this.loading = false;\n        }\n      })();\n    }\n    cargarInscripciones(id) {\n      this.apiService.getInscripcionAlumno(id).subscribe({\n        next: data => {\n          this.inscripciones = data;\n          this.loading = false;\n        },\n        error: err => {\n          console.error('Error cargando notas', err);\n          this.loading = false;\n        }\n      });\n    }\n    toggleAsignatura(id) {\n      if (this.expandedAsignaturas.has(id)) {\n        this.expandedAsignaturas.delete(id);\n      } else {\n        this.expandedAsignaturas.add(id);\n      }\n    }\n    isExpanded(id) {\n      return this.expandedAsignaturas.has(id);\n    }\n    getPromedioAsignatura(insc) {\n      const notas = insc.notas || [];\n      if (!notas.length) return 0;\n      const suma = notas.reduce((acc, curr) => {\n        const valor = typeof curr === 'object' ? curr.valor || curr.nota || 0 : curr;\n        return acc + Number(valor);\n      }, 0);\n      return suma / notas.length;\n    }\n    getEstadoAsignatura(promedio) {\n      if (promedio >= 6.0) return {\n        texto: 'Excelente',\n        color: 'success'\n      };\n      if (promedio >= 4.0) return {\n        texto: 'Aprobado',\n        color: 'success'\n      };\n      return {\n        texto: 'Requiere Mejora',\n        color: 'warning'\n      };\n    }\n    get promedioGeneral() {\n      if (!this.inscripciones.length) return 0;\n      let sumaPromedios = 0;\n      let count = 0;\n      this.inscripciones.forEach(insc => {\n        const notas = insc.notas || [];\n        if (notas.length > 0) {\n          sumaPromedios += this.getPromedioAsignatura(insc);\n          count++;\n        }\n      });\n      return count > 0 ? sumaPromedios / count : 0;\n    }\n    get aprobadas() {\n      return this.inscripciones.filter(insc => {\n        const notas = insc.notas || [];\n        if (notas.length === 0) return false;\n        return this.getPromedioAsignatura(insc) >= 4.0;\n      }).length;\n    }\n    getProgreso(promedio) {\n      const pct = promedio / 7 * 100;\n      return Math.max(0, Math.min(100, pct));\n    }\n    fmt(n) {\n      return n.toFixed(1);\n    }\n  }\n  NotasPage.ɵfac = function NotasPage_Factory(t) {\n    return new (t || NotasPage)(i0.ɵɵdirectiveInject(i1.ApiService));\n  };\n  NotasPage.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: NotasPage,\n    selectors: [[\"app-notas\"]],\n    decls: 54,\n    vars: 9,\n    consts: [[3, \"fullscreen\"], [1, \"app-header\"], [2, \"display\", \"flex\", \"justify-content\", \"space-between\", \"align-items\", \"center\", \"margin-bottom\", \"20px\"], [1, \"brand\", 2, \"display\", \"flex\", \"align-items\", \"center\", \"gap\", \"8px\", \"font-weight\", \"700\", \"font-size\", \"1.2rem\"], [\"defaultHref\", \"/home\", 2, \"color\", \"white\", \"margin-right\", \"8px\"], [\"name\", \"trophy-outline\"], [1, \"header-stats\"], [1, \"stat-box\"], [1, \"stat-number\"], [1, \"stat-label\"], [1, \"app-body\"], [1, \"card\"], [1, \"card-header\", 2, \"margin-bottom\", \"10px\"], [1, \"card-title\"], [1, \"card-subtitle\"], [\"class\", \"ion-text-center ion-padding\", 4, \"ngIf\"], [\"lines\", \"none\", \"class\", \"cards\", \"style\", \"background: transparent; padding: 0;\", 4, \"ngIf\"], [1, \"tabs\"], [\"slot\", \"bottom\"], [\"routerLink\", \"/home\"], [\"name\", \"home-outline\"], [\"routerLink\", \"/notas\", \"selected\", \"true\"], [\"name\", \"book-outline\"], [\"routerLink\", \"/asistencia\"], [\"name\", \"calendar-outline\"], [\"routerLink\", \"/chat\"], [\"name\", \"chatbubble-ellipses-outline\"], [1, \"ion-text-center\", \"ion-padding\"], [\"lines\", \"none\", 1, \"cards\", 2, \"background\", \"transparent\", \"padding\", \"0\"], [\"class\", \"grade-container\", \"style\", \"margin-bottom: 12px;\", 4, \"ngFor\", \"ngForOf\"], [1, \"grade-container\", 2, \"margin-bottom\", \"12px\"], [\"button\", \"\", 1, \"grade-item\", 2, \"--background\", \"var(--surface)\", \"border-radius\", \"16px\", \"margin\", \"0\", \"box-shadow\", \"var(--shadow-card)\", 3, \"click\"], [\"name\", \"book-outline\", \"slot\", \"start\", \"color\", \"primary\"], [1, \"row\", 2, \"display\", \"flex\", \"justify-content\", \"space-between\", \"align-items\", \"center\", \"margin-bottom\", \"8px\"], [2, \"margin\", \"0\", \"font-weight\", \"700\", \"font-size\", \"16px\", \"color\", \"var(--text-main)\"], [\"outline\", \"true\", 2, \"height\", \"24px\", 3, \"color\"], [2, \"font-size\", \"12px\"], [\"role\", \"progressbar\", 1, \"bar\", 2, \"height\", \"6px\", \"background\", \"#e5e7eb\", \"border-radius\", \"99px\", \"overflow\", \"hidden\", \"margin-bottom\", \"8px\"], [1, \"fill\", 2, \"height\", \"100%\", \"background\", \"linear-gradient(90deg, var(--state-success), var(--color-primary))\"], [2, \"margin\", \"0\", \"font-size\", \"13px\", \"color\", \"var(--text-secondary)\"], [2, \"color\", \"var(--text-main)\"], [\"slot\", \"end\", \"color\", \"medium\", 3, \"name\"], [\"class\", \"grade-details\", \"style\", \"background: var(--surface); border-bottom-left-radius: 16px; border-bottom-right-radius: 16px; border-top: 1px solid #E5E7EB; padding: 0 0 8px 0; margin-top: -4px; padding-top: 4px;\", 4, \"ngIf\"], [1, \"grade-details\", 2, \"background\", \"var(--surface)\", \"border-bottom-left-radius\", \"16px\", \"border-bottom-right-radius\", \"16px\", \"border-top\", \"1px solid #E5E7EB\", \"padding\", \"0 0 8px 0\", \"margin-top\", \"-4px\", \"padding-top\", \"4px\"], [\"lines\", \"full\"], [\"style\", \"--background: transparent; font-size: 14px;\", 4, \"ngFor\", \"ngForOf\"], [\"style\", \"--background: transparent;\", 4, \"ngIf\"], [2, \"--background\", \"transparent\", \"font-size\", \"14px\"], [2, \"font-weight\", \"600\", \"font-size\", \"14px\", \"color\", \"var(--text-main)\"], [2, \"font-size\", \"12px\", \"color\", \"var(--text-secondary)\"], [\"color\", \"primary\", \"slot\", \"end\"], [2, \"--background\", \"transparent\"], [1, \"ion-text-center\"], [2, \"color\", \"var(--text-secondary)\", \"font-size\", \"13px\"]],\n    template: function NotasPage_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"ion-content\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 3);\n        i0.ɵɵelement(4, \"ion-back-button\", 4)(5, \"ion-icon\", 5);\n        i0.ɵɵelementStart(6, \"span\");\n        i0.ɵɵtext(7, \"Rendimiento\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(8, \"div\", 6)(9, \"div\", 7)(10, \"span\", 8);\n        i0.ɵɵtext(11);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"span\", 9);\n        i0.ɵɵtext(13, \"Asignaturas\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(14, \"div\", 7)(15, \"span\", 8);\n        i0.ɵɵtext(16);\n        i0.ɵɵpipe(17, \"number\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"span\", 9);\n        i0.ɵɵtext(19, \"Promedio\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(20, \"div\", 7)(21, \"span\", 8);\n        i0.ɵɵtext(22);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(23, \"span\", 9);\n        i0.ɵɵtext(24, \"Aprobadas\");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(25, \"div\", 10)(26, \"div\", 11)(27, \"div\", 12)(28, \"h3\", 13);\n        i0.ɵɵtext(29, \"Mis asignaturas\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(30, \"p\", 14);\n        i0.ɵɵtext(31, \"\\u00DAltima actualizaci\\u00F3n reciente\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(32, NotasPage_div_32_Template, 2, 0, \"div\", 15);\n        i0.ɵɵtemplate(33, NotasPage_ion_list_33_Template, 2, 1, \"ion-list\", 16);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(34, \"ion-footer\", 17)(35, \"ion-toolbar\")(36, \"ion-tabs\")(37, \"ion-tab-bar\", 18)(38, \"ion-tab-button\", 19);\n        i0.ɵɵelement(39, \"ion-icon\", 20);\n        i0.ɵɵelementStart(40, \"ion-label\");\n        i0.ɵɵtext(41, \"Inicio\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(42, \"ion-tab-button\", 21);\n        i0.ɵɵelement(43, \"ion-icon\", 22);\n        i0.ɵɵelementStart(44, \"ion-label\");\n        i0.ɵɵtext(45, \"Notas\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(46, \"ion-tab-button\", 23);\n        i0.ɵɵelement(47, \"ion-icon\", 24);\n        i0.ɵɵelementStart(48, \"ion-label\");\n        i0.ɵɵtext(49, \"Asistencia\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(50, \"ion-tab-button\", 25);\n        i0.ɵɵelement(51, \"ion-icon\", 26);\n        i0.ɵɵelementStart(52, \"ion-label\");\n        i0.ɵɵtext(53, \"Chat\");\n        i0.ɵɵelementEnd()()()()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵproperty(\"fullscreen\", true);\n        i0.ɵɵadvance(11);\n        i0.ɵɵtextInterpolate(ctx.inscripciones.length);\n        i0.ɵɵadvance(5);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(17, 6, ctx.promedioGeneral, \"1.1-1\"));\n        i0.ɵɵadvance(6);\n        i0.ɵɵtextInterpolate(ctx.aprobadas);\n        i0.ɵɵadvance(10);\n        i0.ɵɵproperty(\"ngIf\", ctx.loading);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.loading);\n      }\n    },\n    dependencies: [i2.NgForOf, i2.NgIf, i3.IonBackButton, i3.IonBadge, i3.IonChip, i3.IonContent, i3.IonFooter, i3.IonIcon, i3.IonItem, i3.IonLabel, i3.IonList, i3.IonSpinner, i3.IonTabBar, i3.IonTabButton, i3.IonToolbar, i3.IonTabs, i3.IonBackButtonDelegate, i3.RouterLinkDelegate, i4.RouterLink, i2.DecimalPipe, i2.DatePipe],\n    styles: [\".grades-header[_ngcontent-%COMP%]{background:var(--chronos-primary);color:#fff;padding-bottom:8px}.header-toolbar[_ngcontent-%COMP%]{--background: transparent;color:#fff}.brand[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-weight:700}.brand[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:22px}.quick-stats[_ngcontent-%COMP%]{padding:0 12px 12px}.stat[_ngcontent-%COMP%]{background:rgba(255,255,255,.18);backdrop-filter:blur(6px);border:1px solid rgba(255,255,255,.25);border-radius:12px;padding:10px 8px;text-align:center;color:#fff}.stat[_ngcontent-%COMP%]   .kpi[_ngcontent-%COMP%]{font-size:18px;font-weight:800;line-height:1.1;margin-top:4px}.stat[_ngcontent-%COMP%]   .lbl[_ngcontent-%COMP%]{font-size:12px;opacity:.9}.grades-content[_ngcontent-%COMP%]{--background: var(--chronos-bg-light)}.card[_ngcontent-%COMP%]{background:rgba(255,255,255,.5);backdrop-filter:blur(10px);border-radius:16px;box-shadow:0 8px 28px #1018280f;border:1px solid rgba(255,255,255,.4)}.cards[_ngcontent-%COMP%]{padding:0 16px 16px;background:transparent}.grade-container[_ngcontent-%COMP%]{margin-bottom:12px}.grade-item[_ngcontent-%COMP%]{--background: var(--chronos-card-bg);--padding-start: 16px;--inner-padding-end: 16px;border-radius:16px;box-shadow:0 4px 6px -1px #0000001a;border:1px solid #E5E7EB;margin:0}.grade-item.expanded[_ngcontent-%COMP%]{border-bottom-left-radius:0;border-bottom-right-radius:0;border-bottom:none}.grade-details[_ngcontent-%COMP%]{background:var(--chronos-card-bg);border-bottom-left-radius:16px;border-bottom-right-radius:16px;border:1px solid #E5E7EB;border-top:none;padding:0 0 8px;margin-top:-1px}.grade-details[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: transparent;--min-height: 48px;font-size:14px}.grade-details[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-weight:600;font-size:14px;color:var(--chronos-text)}.grade-details[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:12px;color:var(--chronos-text-secondary)}.grade-item[_ngcontent-%COMP%]   ion-icon[slot=start][_ngcontent-%COMP%]{font-size:24px;margin-right:16px;color:var(--chronos-primary);background:var(--chronos-secondary);padding:8px;border-radius:12px}.grade-item[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}.grade-item[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-weight:700;font-size:16px;color:var(--chronos-text)}.bar[_ngcontent-%COMP%]{height:6px;background:#e5e7eb;border-radius:99px;overflow:hidden;margin-bottom:8px}.bar[_ngcontent-%COMP%]   .fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,var(--chronos-success),var(--chronos-primary));border-radius:99px;transition:width .5s ease-out}.grade-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:13px;color:var(--chronos-text-secondary)}.grade-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{color:var(--chronos-text)}ion-footer.tabs[_ngcontent-%COMP%]{position:sticky;bottom:0}\"]\n  });\n  return NotasPage;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}